<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./style/home.css" />
    <link rel="stylesheet" href="./style/master.css" />
  </head>
  <body>
    <div class="bannerArea">
      <div class="wrap">
        <div class="bannerBox">
          <div class="bannerList slickClsList" id="banner">
            <div class="bannerItem slickClsItem">
              <div class="Img">
                <div
                  data-i="10"
                  data-imgurl="./img/88761-3__25A2298H0Z.jpg"
                  class="slickGrid"
                ></div>
                <img src="./img/88761-3__25A2298H0Z.jpg" />
              </div>

              <div class="Txt">
                <div class="textBox textEditor"></div>

                <div class="textBox">
                  <h1 class="title">臺灣精品磁磚領導品牌一塊改變</h1>

                  <div class="subtitle">實現美好生活</div>

                  <p class="text"></p>
                </div>
              </div>
              <!-- <script>
                if (document.querySelector("picture")) {
                  function updateSourceImage() {
                    document
                      .querySelectorAll("picture source.slickGrid")
                      .forEach((item, index) => {
                        if (window.innerWidth < 640) {
                          item.setAttribute(
                            "data-imgurl",
                            "<?php echo $data_mobile_pic; ?>",
                          );
                          item.setAttribute(
                            "srcset",
                            "<?php echo $data_mobile_pic; ?>",
                          );
                        } else {
                          item.setAttribute(
                            "data-imgurl",
                            "<?php echo $data_list_pic; ?>",
                          );
                          item.setAttribute(
                            "srcset",
                            "<?php echo $data_list_pic; ?>",
                          );
                        }
                      });
                  }

                  // 初始更新一次
                  updateSourceImage();

                  function debounce(func, delay) {
                    let timer;
                    return (...args) => {
                      clearTimeout(timer);
                      timer = setTimeout(() => func(...args), delay);
                    };
                  }

                  // 當視窗尺寸改變時更新
                  window.addEventListener(
                    "resize",
                    debounce(updateSourceImage, 200),
                  );
                }
              </script> -->
            </div>
            <div class="bannerItem slickClsItem">
              <div class="Img">
                <div
                  data-i="10"
                  data-imgurl="./img/88761-3__25A2298H0Z.jpg"
                  class="slickGrid"
                ></div>
                <img src="./img/88761-3__25A2298H0Z.jpg" />
              </div>

              <div class="Txt">
                <div class="textBox textEditor"></div>

                <div class="textBox">
                  <h1 class="title">臺灣精品磁磚領導品牌 一塊改變</h1>

                  <div class="subtitle">實現美好生活</div>

                  <p class="text"></p>
                </div>
              </div>
              <!-- <script>
                if (document.querySelector("picture")) {
                  function updateSourceImage() {
                    document
                      .querySelectorAll("picture source.slickGrid")
                      .forEach((item, index) => {
                        if (window.innerWidth < 640) {
                          item.setAttribute(
                            "data-imgurl",
                            "<?php echo $data_mobile_pic; ?>",
                          );
                          item.setAttribute(
                            "srcset",
                            "<?php echo $data_mobile_pic; ?>",
                          );
                        } else {
                          item.setAttribute(
                            "data-imgurl",
                            "<?php echo $data_list_pic; ?>",
                          );
                          item.setAttribute(
                            "srcset",
                            "<?php echo $data_list_pic; ?>",
                          );
                        }
                      });
                  }

                  // 初始更新一次
                  updateSourceImage();

                  function debounce(func, delay) {
                    let timer;
                    return (...args) => {
                      clearTimeout(timer);
                      timer = setTimeout(() => func(...args), delay);
                    };
                  }

                  // 當視窗尺寸改變時更新
                  window.addEventListener(
                    "resize",
                    debounce(updateSourceImage, 200),
                  );
                }
              </script> -->
            </div>
            <div class="bannerItem slickClsItem">
              <div class="Img">
                <div
                  data-i="10"
                  data-imgurl="./img/88761-3__25A2298H0Z.jpg"
                  class="slickGrid"
                ></div>
                <img src="./img/88761-3__25A2298H0Z.jpg" />
              </div>

              <div class="Txt">
                <div class="textBox textEditor"></div>

                <div class="textBox">
                  <h1 class="title">臺灣精品磁磚領導品牌 一塊改變</h1>
                  <div class="subtitle">實現美好生活</div>

                  <p class="text"></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <section class="aboutArea">
      <div class="wrap">
        <!-- aboutBox -->
        <div class="aboutBox">
          <div class="Txt">
            <div class="titleBox">
              <div data-splitting class="title slide-horizontal">
                創新設備、技術、與設計
              </div>
              <div class="subtitle">
                秉持「一塊改
                變」的品牌信念，導入義大利瓷磚設備與設計思維，打造歐洲質感國產化瓷磚產品。
              </div>
              <div class="text">
                我們專注於本業經營，擁有專業石英磚廠與研發生產團隊，黃山石瓷磚產品開發以「天然石」與「原生木」兩大親人性主題，透過科技建材取代天然礦石與木材守護自然資源，讓發展與環境共存不再是選擇題。
              </div>
            </div>

            <div class="iconBox">
              <div class="iconList">
                <!--data-->
                <div class="iconItem">
                  <div class="item">
                    <figure class="Img">
                      <img src="./img/twL_aboutpic_25A22_1it5Z31UqV.png" />
                    </figure>

                    <div class="Txt">
                      <div class="title">
                        全台皆具 <br />
                        經銷據點
                      </div>
                    </div>
                  </div>
                </div>
                <div class="iconItem">
                  <div class="item">
                    <figure class="Img">
                      <img src="./img/twL_aboutpic_25A22_D4FpQi7xyq.png" />
                    </figure>

                    <div class="Txt">
                      <div class="title">
                        全產品頂規 <br />
                        5級抗污
                      </div>
                    </div>
                  </div>
                </div>
                <div class="iconItem">
                  <div class="item">
                    <figure class="Img">
                      <img src="./img/twL_aboutpic_25A22_qhYEHcIuhF.png" />
                    </figure>

                    <div class="Txt">
                      <div class="title">
                        綠建材產品線 <br />
                        最完善
                      </div>
                    </div>
                  </div>
                </div>
                <!--data-->
              </div>
            </div>
          </div>

          <figure class="Img">
            <div
              class="grid"
              data-i="9"
              data-imgurl="./img/iStock-1444491531__25A22qs6Pu.jpg"
            ></div>

            <img src="./img/iStock-1444491531__25A22qs6Pu.jpg" />
          </figure>
        </div>
        <!-- aboutBox end -->
      </div>
    </section>

    <section class="keyProductArea">
      <div class="wrap">
        <!-- linkBox -->
        <div class="keyProductBox">
          <div class="keyProductList">
            <!--data-->
            <div class="keyProductItem">
              <div class="item">
                <div class="Img">
                  <img src="./img/twL_keyproduct_25A23_ECPgvq0Oxf.jpg" />

                  <div class="mask"></div>
                  <div class="mask2"></div>
                </div>

                <div class="Txt">
                  <div class="title">當代原木系列</div>
                  <div class="line"></div>
                </div>
              </div>
            </div>
            <div class="keyProductItem">
              <div class="item">
                <div class="Img">
                  <img src="./img/twL_keyproduct_25D09_6kY6bchSH1.png" />

                  <div class="mask"></div>
                  <div class="mask2"></div>
                </div>

                <div class="Txt">
                  <div class="title">當代原木系列</div>
                  <div class="line"></div>
                </div>
              </div>
            </div>
            <div class="keyProductItem">
              <div class="item">
                <div class="Img">
                  <img src="./img/twL_keyproduct_25D09_nCQlykoyNl.png" />

                  <div class="mask"></div>
                  <div class="mask2"></div>
                </div>

                <div class="Txt">
                  <div class="title">當代原木系列</div>
                  <div class="line"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- linkBox end -->
      </div>
    </section>

    <!--projectArea-->
    <section class="projectArea">
      <div class="wrap">
        <div class="titleWrap">
          <div class="titleBox">
            <div class="title">風格展示</div>
            <div class="subtitle">
              用瓷磚勾勒生活的細節，打造專屬你的質感日常。
            </div>
          </div>
        </div>
      </div>
      <div class="wrap2">
        <!-- projectBox -->
        <div class="projectBox">
          <div class="projectList slickClsList">
            <!-- data -->
            <div class="projectItem slickClsItem">
              <div class="item">
                <figure class="Img">
                  <img src="./img/36149__25J21FZIYj.jpg" />
                </figure>

                <div class="Txt">
                  <div class="textBox">
                    <h3 class="title">極簡風</h3>
                  </div>
                </div>
              </div>
            </div>
            <div class="projectItem slickClsItem">
              <div class="item">
                <figure class="Img">
                  <img src="./img/42560-3__25J21T6ZCP.jpg" />
                </figure>

                <div class="Txt">
                  <div class="textBox">
                    <h3 class="title">北歐風</h3>
                  </div>
                </div>
              </div>
            </div>
            <div class="projectItem slickClsItem">
              <div class="item">
                <figure class="Img">
                  <img src="./img/36149__25J21FZIYj.jpg" />
                </figure>

                <div class="Txt">
                  <div class="textBox">
                    <h3 class="title">現代風</h3>
                  </div>
                </div>
              </div>
            </div>
            <div class="projectItem slickClsItem">
              <div class="item">
                <figure class="Img">
                  <img src="./img/61791-2__25J08HurB0.jpg" />
                </figure>

                <div class="Txt">
                  <div class="textBox">
                    <h3 class="title">工業風</h3>
                  </div>
                </div>
              </div>
            </div>
            <div class="projectItem slickClsItem">
              <div class="item">
                <figure class="Img">
                  <img src="./img/36149__25J21FZIYj.jpg" />
                </figure>

                <div class="Txt">
                  <div class="textBox">
                    <h3 class="title">日式風</h3>
                  </div>
                </div>
              </div>
            </div>
            <!-- data end -->
          </div>
        </div>
      </div>
    </section>
    <!--projectArea end-->

    <section class="linkArea">
      <!-- <div class="mainColorBox"></div> -->
      <div class="wrap">
        <!-- titleBox -->
        <div class="titleBox">
          <div class="decoTitle"></div>

          <h2 data-splitting class="title slide-horizontal dark">空間展示</h2>

          <div class="subtitle"></div>

          <div class="text">探索瓷磚如何融入日常，定義空間的質感語言</div>
        </div>

        <!-- titleBox end -->

        <!-- linkBox -->
        <div class="linkBox">
          <div class="linkList">
            <!--data-->
            <div class="linkItem">
              <div class="item">
                <div
                  class="grid"
                  data-i="4"
                  data-imgurl="./img/twL_marqueepic_25B03_Ha5DoTsdsV.jpg"
                ></div>
                <figure class="Img">
                  <img src="./img/twL_marqueepic_25B03_Ha5DoTsdsV.jpg" />
                </figure>

                <div class="Txt">
                  <h3 class="title">客廳空間</h3>
                </div>

                <div class="mask">
                  <img src="./img/linkmask.png" alt="mask" />
                </div>
              </div>
            </div>
            <div class="linkItem">
              <div class="item">
                <div
                  class="grid"
                  data-i="6"
                  data-imgurl="./img/twL_marqueepic_25B03_lPX1tKTn5T.jpg"
                ></div>
                <figure class="Img">
                  <img src="./img/twL_marqueepic_25B03_lPX1tKTn5T.jpg" />
                </figure>

                <div class="Txt">
                  <h3 class="title">戶外空間</h3>
                </div>

                <div class="mask">
                  <img src="./img/linkmask.png" alt="mask" />
                </div>
              </div>
            </div>
            <div class="linkItem">
              <div class="item">
                <div
                  class="grid"
                  data-i="5"
                  data-imgurl="./img/twL_marqueepic_25B03_QbDIHKKMu0.jpg"
                ></div>
                <figure class="Img">
                  <img src="./img/twL_marqueepic_25B03_QbDIHKKMu0.jpg" />
                </figure>

                <div class="Txt">
                  <h3 class="title">商業空間</h3>
                </div>

                <div class="mask">
                  <img src="./img/linkmask.png" alt="mask" />
                </div>
              </div>
            </div>
            <div class="linkItem">
              <div class="item">
                <div
                  class="grid"
                  data-i="3"
                  data-imgurl="./img/twL_marqueepic_25B03_TCbCfnXE2U.jpg"
                ></div>
                <figure class="Img">
                  <img src="./img/twL_marqueepic_25B03_TCbCfnXE2U.jpg" />
                </figure>

                <div class="Txt">
                  <h3 class="title">浴室空間</h3>
                </div>

                <div class="mask">
                  <img src="./img/linkmask.png" alt="mask" />
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- linkBox end -->

        <div class="btnBox">
          <a class="btn bgMain">
            <span class="btnText"> 了解更多 </span>
          </a>
        </div>
      </div>
    </section>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"
    />

    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"
    ></script>

    <script src="https://unpkg.com/lenis@1.3.17/dist/lenis.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/gsap@3.14.1/dist/gsap.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/gsap@3.14.1/dist/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.14.1/dist/SplitText.min.js"></script>

    <script src="./splitting.js"></script>

    <script>
      gsap.config({
        nullTargetWarn: false,
      });

      Splitting();

      function lenisHandle() {
        const target = document.querySelector("body");
        const disabledScrollClass = [
          "overflow",
          "popwinOverflow",
          "loadingOverflow",
          "lg-on",
        ];
        const observer = new MutationObserver((mutations) => {
          mutations.forEach((mutation) => {
            const { attributeName, target } = mutation;
            if (
              disabledScrollClass.some((className) =>
                target.classList.contains(className),
              )
            )
              lenis.stop();
            else lenis.start();
          });
        });

        observer.observe(target, {
          attributeFilter: ["class"],
        });
      }

      function lenisInit() {
        const lenis = new Lenis({
          lerp: 0.055,
        });

        lenis.on("scroll", ScrollTrigger.update);
        gsap.ticker.add((time) => {
          lenis.raf(time * 1000);
        });
        gsap.ticker.lagSmoothing(0);
        window.lenis = lenis;

        function raf(time) {
          lenis.raf(time);
          requestAnimationFrame(raf);
        }

        requestAnimationFrame(raf);

        setTimeout(lenisHandle, 100);
      }

      lenisInit();

      if (!$(".bannerArea").length) {
        $("header").addClass("bgColor");
        $(".titleBox").addClass("show");
        $(".bread").addClass("show");
        $(".brickBox").addClass("active");
      } else {
        $(window).on("scroll", function () {
          var scroll = $(this).scrollTop();
          $("header").toggleClass("bgColor", scroll >= 100);
        });

        if (window.innerWidth > 1180) {
          ScrollTrigger.create({
            trigger: ".bannerArea", // 設定觸發的目標
            start: "150% bottom", // 設定觸發點，例如目標頂部到達視窗中間
            end: "bottom center", // 設定觸發結束點
            onEnter: () => $(".brickBox").addClass("active"), // 當進入觸發區域時添加 class
            onLeaveBack: () => $(".brickBox").removeClass("active"), // 當離開觸發區域時移除 class
          });
        }
      }

      document.querySelectorAll(".btnBox .btn").forEach((item) => {
        let btnHoverElement = document.createElement("div");
        btnHoverElement.classList.add("hover");
        item.appendChild(btnHoverElement);
      });
    </script>

    <script>
      class GridAnimation {
        constructor(el, fragmentSize = window.innerWidth < 768 ? 110 : 120) {
          this.element = el;
          this.fragmentSize = fragmentSize;
          this.duration = 2000;
          this.delayDelta = 170;
          this.type = null;
          this.imgurl = el.getAttribute("data-imgurl");
          this.updateGrid();
          this.element.addEventListener("click", this.trigger);
          el.nextElementSibling.style.opacity = 0;
          el.nextElementSibling.style.transition = "all 0.5s ease-in-out";
        }

        updateGrid = () => {
          const boxWidth = Math.ceil(
            this.element.nextElementSibling.clientWidth,
          );
          const boxHeight = this.element.nextElementSibling.clientHeight;
          const newCol = Math.round(boxWidth / this.fragmentSize);
          const newRow = Math.round(boxHeight / this.fragmentSize);
          this.col = newCol;
          this.row = newRow;
          this.element.style.setProperty("--box-width", `${boxWidth}px`);
          this.element.style.setProperty("--box-height", `${boxHeight}px`);
          this.element.style.setProperty("--row", this.row);
          this.element.style.setProperty("--col", this.col);
          this.imgurl = this.element.getAttribute("data-imgurl");
        };

        trigger = () => {
          this.element.nextElementSibling.style.opacity = 0;
          this.clear();
          this.element.classList.add("hide");
          this.animate();
        };

        setType = (type) => {
          this.type = type;
        };

        clear = () => {
          this.element
            .querySelectorAll(".fragment")
            .forEach((fragment) => fragment.remove());
        };

        animate = () => {
          if (this.type === null) return;
          const x = this.col - 1;
          const y = this.row - 1;

          for (let i = 0; i < this.row; i++) {
            for (let j = 0; j < this.col; j++) {
              const fragment = document.createElement("div");
              fragment.className = "fragment";
              fragment.style.setProperty("--x", j);
              fragment.style.setProperty("--y", i);
              fragment.style.backgroundImage = `url(${this.imgurl})`;

              let delay = this.calculateDelay(i, j, x, y);
              const isOdd = (i + j) % 2 === 0;
              fragment.style.setProperty(
                "--rotateX",
                `rotateX(${isOdd ? -180 : 0}deg)`,
              );
              fragment.style.setProperty(
                "--rotateY",
                `rotateY(${isOdd ? 0 : -180}deg)`,
              );
              fragment.style.setProperty(
                "--delay",
                `${delay * this.delayDelta}ms`,
              );
              fragment.style.setProperty("--duration", `${this.duration}ms`);

              this.element.appendChild(fragment);

              setTimeout(
                () => {
                  fragment.style.willChange = "initial";
                  fragment.style.transform = "initial";
                  fragment.style.animation = "initial";
                  fragment.style.backfaceVisibility = "initial";
                  fragment.style.opacity = 1;
                },
                this.duration + delay * this.delayDelta,
              );
            }
          }

          setTimeout(
            () => {
              this.element.nextElementSibling.style.opacity = 1;
            },
            this.duration + (x + y) * this.delayDelta,
          );
        };

        calculateDelay(i, j, x, y) {
          switch (this.type) {
            case 0:
              return i * 2;
            case 1:
              return j * 2;
            case 2:
              return this.randomIntBetween(0, x + y);
            case 3:
              return x + y - (j + i);
            case 4:
              return i + j;
            case 5:
              return x - i + j;
            case 6:
              return i + (y - j);
            case 7:
              return Math.abs((x + y) / 2 - (j + i));
            case 8:
              return (x + y) / 2 - Math.abs((x + y) / 2 - (j + i));
            case 9:
              return (
                (x + y) / 2 - Math.abs((x + y) / 2 - (j + i)) * Math.cos(i + j)
              );
            case 10:
              return Math.abs((x + y) / 2 - (x - j + i));
            case 11:
              return Math.abs(
                (x + y) / 2 - Math.abs((x + y) / 2 - (x - j + i)),
              );
            case 12:
              return Math.abs(x / 2 - j) + Math.abs(y / 2 - i);
            case 13:
              return (
                x / 2 - Math.abs(x / 2 - j) + (x / 2 - Math.abs(y / 2 - i))
              );
            default:
              return 0;
          }
        }

        randomIntBetween(min, max) {
          return Math.floor(Math.random() * (max - min + 1) + min);
        }
      }

      // 儲存 GridAnimation 物件
      let gridInstances = [];
      let slickGridInstances = [];

      function initGridAnimation(selector, instanceArray) {
        document.querySelectorAll(selector).forEach((box, index) => {
          const img = box.nextElementSibling;
          img.style.opacity = 0;
          if (img) {
            const width = Math.ceil(img.clientWidth);
            const height = img.clientHeight;
            const fragmentSize = window.innerWidth < 768 ? 110 : 180;
            const col = Math.round(width / fragmentSize);
            const row = Math.round(height / fragmentSize);

            box.style.setProperty("--box-width", `${width}px`);
            box.style.setProperty("--box-height", `${height}px`);
            box.style.setProperty("--col", col);
            box.style.setProperty("--row", row);
          }

          if (!instanceArray[index]) {
            const gridAnimation = new GridAnimation(box);
            gridAnimation.setType(parseInt(box.getAttribute("data-i")));
            instanceArray[index] = gridAnimation;

            // if (!$hasLoading) {
            //   if (index === 0) gridAnimation.trigger();
            // }
          } else {
            instanceArray[index].updateGrid();
          }
        });
      }

      function debounce(func, delay) {
        let timer;
        return (...args) => {
          clearTimeout(timer);
          timer = setTimeout(() => func(...args), delay);
        };
      }

      // 初始載入
      window.addEventListener("load", () => {
        initGridAnimation(".grid", gridInstances);
        initGridAnimation(".slickGrid", slickGridInstances);

        slickGridInstances[0].trigger();

        gsap.utils.toArray(".grid").forEach((item, index) => {
          ScrollTrigger.create({
            trigger: item,
            start: "top bottom",
            end: "bottom center",
            once: true, // ✅ 只執行一次

            onEnter: () => {
              gridInstances[index].updateGrid();
              gridInstances[index].trigger();
            },
          });
        });
      });

      // 監聽視窗縮放，避免過度觸發
      const handleResize = debounce(() => {
        gridInstances.forEach((instance) => {
          instance.updateGrid();
          instance.trigger();
        });
        slickGridInstances.forEach((instance) => {
          instance.updateGrid();
          instance.trigger();
        });
      }, 200);

      window.addEventListener("resize", handleResize);

      ScrollTrigger.batch(".titleBox .title .char", {
        start: "top 90%",
        end: "bottom 60%",
        once: true, // 只執行一次動畫

        onEnter: (batch) => {
          batch.forEach((item) => item.classList.add("ani"));
        },
      });

      ScrollTrigger.batch(".titleBox2 .title .char", {
        start: "top 90%",
        end: "bottom 60%",
        once: true, // 只執行一次動畫

        onEnter: (batch) => {
          batch.forEach((item) => item.classList.add("ani"));
        },
      });

      ScrollTrigger.batch(".introArea .articleTitle .char", {
        start: "20% 70%",
        end: "bottom 60%",
        once: true, // 只執行一次動畫

        onEnter: (batch) => {
          batch.forEach((item) => item.classList.add("ani"));
        },
      });

      ScrollTrigger.batch(".topBox .filterTitle .char", {
        start: "top 90%",
        end: "bottom 60%",
        once: true, // 只執行一次動畫

        onEnter: (batch) => {
          batch.forEach((item) => item.classList.add("ani"));
        },
      });

      ScrollTrigger.batch(".leftBox .sectionTitle strong .char", {
        start: "top 90%",
        end: "bottom 60%",
        once: true, // 只執行一次動畫

        onEnter: (batch) => {
          batch.forEach((item) => item.classList.add("ani"));
        },
      });

      ScrollTrigger.batch(".catalogSpecTitleBox .char", {
        start: "top 90%",
        end: "bottom 60%",
        once: true, // 只執行一次動畫

        onEnter: (batch) => {
          batch.forEach((item) => item.classList.add("ani"));
        },
      });

      ScrollTrigger.batch(".Txt .title .char", {
        start: "top 90%",
        end: "bottom 60%",
        once: true, // 只執行一次動畫

        onEnter: (batch) => {
          batch.forEach((item) => item.classList.add("ani"));
        },
      });

      gsap.utils.toArray(".introArea .TxtItem").forEach((item, index) => {
        gsap.from(item, {
          clipPath: "inset(0 100% 0 0)",
          opacity: 0,
          duration: 2.5,
          delay: index * 0.2,
          scrollTrigger: {
            trigger: item,
            start: "top 90%",
            end: "bottom 60%",
          },
        });
      });

      gsap.utils.toArray(".patternArea .specTitle").forEach((item, index) => {
        gsap.from(item, {
          x: -30,
          opacity: 0,
          duration: 1,

          scrollTrigger: {
            trigger: item,
            start: "top 90%",
            end: "bottom 60%",
          },
        });
      });

      gsap.utils.toArray(".classLink li").forEach((item, index) => {
        gsap.from(item, {
          y: 30,
          opacity: 0,
          duration: 1,
          delay: index * 0.2,
          scrollTrigger: {
            trigger: item,
            start: "top 90%",
            end: "bottom 60%",
          },
        });
      });

      const t2 = gsap.timeline({
        scrollTrigger: {
          trigger: ".aboutPage .techArea",
          start: "top 90%",
          end: "bottom 60%",
        },
      });

      t2.from(".aboutPage .techArea .techItem .item .year .char", {
        x: -30,
        opacity: 0,
        duration: 1,
        stagger: 0.07,
      })
        .from(
          ".aboutPage .techArea .techItem .item .title",
          {
            x: 30,
            opacity: 0,
            duration: 2,
            stagger: 0.2,
          },
          "<",
        )
        .from(
          ".aboutPage .techArea .circleBox .circle",
          {
            opacity: 0,
            duration: 1,
            stagger: 0.2,
          },
          "<",
        )
        .from(
          ".aboutPage .techArea .circleBox  .line",
          {
            clipPath: "inset(0 0 100% 0)",
            duration: 1,
            stagger: 0.1,
          },
          "<",
        );

      document
        .querySelectorAll(".projectPage .projectList .item .Img")
        .forEach((item, index) => {
          gsap.fromTo(
            item,
            {
              rotationY: isMobile ? -15 : -35,
              x: isMobile ? -50 : -100,
              rotationX: 15,
              opacity: 0,
              z: 50,
              pointerEvents: "none",
            },
            {
              rotationY: 0,
              rotationX: 0,
              x: 0,
              z: 0,
              opacity: 1,
              duration: 1,
              delay: index * 0.15,
              ease: "power1.inOut",
              pointerEvents: "auto",
              scrollTrigger: {
                trigger: ".projectList",
                start: "top 85%",
              },
              onComplete: function () {
                // 動畫完成後，清除 GSAP 設定的 transform 與 opacity 等 inline 樣式
                gsap.set(item, {
                  clearProps: "all",
                });

                item.style.transition = "all 0.5s ease-in-out";
              },
            },
          );
        });

      const t3 = gsap.timeline({
        scrollTrigger: {
          trigger: ".patternArea",
          start: "30% 90%",
          end: "bottom 60%",
        },
      });

      t3.from(".patternArea .specItem .item .Img", {
        scale: 0,
        duration: 1.2,
        stagger: 0.1,
      });

      const t4 = gsap.timeline({
        scrollTrigger: {
          trigger: ".patternArea",
          start: "30% 90%",
          end: "bottom 60%",
        },
      });

      t4.from(".patternArea .specItem .item .title", {
        y: 30,
        opacity: 0,
        duration: 1,
        stagger: 0.1,
      });

      gsap.from(".textEditor .contentBuilder", {
        y: 50,
        opacity: 0,
        duration: 1,
        stagger: 0.4,
      });
    </script>

    <!--slick-->
    <script>
      $(function () {
        $(".bannerList").on({
          init: function (event, slick) {
            slick.$slides[0]
              .querySelector("img")
              .style.setProperty("opacity", "0", "important");
          },

          beforeChange: function (event, slick, currentSlide, nextSlide) {
            slickGridInstances[nextSlide].trigger();
          },
        });

        $(".bannerList")
          .slick({
            arrows: false,
            autoplay: false,
            autoplaySpeed: 5000,
            cssEase: "ease-in-out",
            dots: true,
            dotsClass: "slick-dots  center",
            fade: true,
            infinite: true,
            lazyLoad: "ondemand",
            speed: 600,
            slidesToShow: 1,
            slidesToScroll: 1,
          })
          .on("lazyLoaded", function (event, slick, image, imageSource) {
            $(image).parents(".Img.observerSlick").addClass("loaded");
          });

        //banner scrollDown
        $(".bannerArea .scrollDown").on("click", function () {
          $("html, body")
            .stop()
            .animate(
              {
                scrollTop:
                  $("#mainArea").offset().top - $("header").outerHeight(),
              },
              600,
            );
        });

        $(".iconListm").on({
          init: function () {
            $(".slick-current").next().addClass("after");
          },
          beforeChange: function () {
            $(".iconListm .slick-slide").removeClass("after");
          },
          afterChange: function () {
            $(".slick-current").next().addClass("after");
          },
        });

        $(".iconListm")
          .slick({
            arrows: false,
            autoplaySpeed: 3000,
            cssEase: "ease-in-out",
            dots: true,
            dotsClass: "slick-dots center green",
            infinite: true,
            lazyLoad: "ondemand",
            speed: 600,
            slidesToShow: 2,
            slidesToScroll: 1,
          })
          .on("lazyLoaded", function (event, slick, image, imageSource) {
            $(image).parents(".Img.observerSlick").addClass("loaded");
          });
        if ($(".ellipsis").length) {
          $(".ellipsis").dotdotdot({
            wrap: "letter",
            remove: [" ", ",", ";", ".", "!", "?"],
            watch: true,
          });
        }

        $(".newsList")
          .slick({
            arrows: false,
            autoplay: true,
            autoplaySpeed: 3000,
            cssEase: "ease-in-out",
            dots: true,
            dotsClass: "slick-dots center",
            infinite: true,
            lazyLoad: "ondemand",
            speed: 600,
            slidesToShow: 3,
            slidesToScroll: 1,
            vertical: true,
            verticalSwiping: true,
            responsive: [
              {
                breakpoint: 768,
                settings: {
                  verticalSwiping: false,
                },
              },
            ],
          })
          .on("lazyLoaded", function (event, slick, image, imageSource) {
            $(image).parents(".Img.observerSlick").addClass("loaded");
          });

        let isMobile = window.innerWidth <= 768;

        $(".projectList").on({
          init: function () {
            document
              .querySelectorAll(".projectArea .projectList .projectItem .Img")
              .forEach(function (item, index) {
                gsap.fromTo(
                  item,
                  {
                    rotationY: isMobile ? -15 : -35,
                    x: isMobile ? -50 : -100,
                    rotationX: 15,
                    opacity: 0,
                    z: 50,
                    // pointerEvents: 'none'
                  },
                  {
                    rotationY: 0,
                    rotationX: 0,
                    x: 0,
                    opacity: 1,
                    duration: 1,
                    delay: index * 0.15,
                    z: 0,
                    pointerEvents: "auto",
                    ease: "power1.inOut",
                    scrollTrigger: {
                      trigger: ".projectArea",
                      start: "top 85%",
                    },
                    onComplete: function () {
                      // 動畫完成後，清除 GSAP 設定的 transform 與 opacity 等 inline 樣式
                      gsap.set(item, {
                        clearProps: "all",
                      });

                      item.style.transition = "all 0.5s ease-in-out";
                    },
                  },
                );
              });
          },
        });

        $(".projectList")
          .slick({
            arrows: true,
            autoplay: true,
            autoplaySpeed: 3000,
            cssEase: "ease-in-out",
            dots: false,
            dotsClass: "slick-dots  green",
            infinite: true,
            // lazyLoad: "ondemand",
            speed: 800,
            slidesToShow: 5,
            slidesToScroll: 1,
            responsive: [
              {
                breakpoint: 1181,
                settings: {
                  slidesToShow: 4,
                },
              },
              {
                breakpoint: 881,
                settings: {
                  slidesToShow: 3,
                },
              },
              {
                breakpoint: 769,
                settings: {
                  slidesToShow: 1,
                },
              },
            ],
          })
          .on("lazyLoaded", function (event, slick, image, imageSource) {
            $(image).parents(".Img.observerSlick").addClass("loaded");
          });

        $(".catalogList")
          .slick({
            arrows: false,
            autoplay: true,
            autoplaySpeed: 3000,
            cssEase: "ease-in-out",
            dots: true,
            dotsClass: "slick-dots center",
            infinite: true,
            lazyLoad: "ondemand",
            speed: 600,
            slidesToShow: 3,
            slidesToScroll: 1,
            responsive: [
              {
                breakpoint: 841,
                settings: {
                  slidesToShow: 2,
                },
              },
              {
                breakpoint: 481,
                settings: {
                  slidesToShow: 1,
                },
              },
            ],
          })
          .on("lazyLoaded", function (event, slick, image, imageSource) {
            $(image).parents(".Img.observerSlick").addClass("loaded");
          });

        $(".facList")
          .slick({
            arrows: true,
            appendArrows: ".facBox .controlBox .arrowBox",
            autoplay: true,
            autoplaySpeed: 3000,
            cssEase: "ease-in-out",
            dots: true,
            appendDots: ".facBox .controlBox .dotsBox",
            dotsClass: "slick-dots white",
            infinite: true,
            lazyLoad: "progressive",
            speed: 600,
            slidesToShow: 4,
            slidesToScroll: 1,
            responsive: [
              {
                breakpoint: 1441,
                settings: {
                  slidesToShow: 3,
                },
              },
              {
                breakpoint: 961,
                settings: {
                  slidesToShow: 2,
                },
              },
              {
                breakpoint: 761,
                settings: {
                  slidesToShow: 1,
                },
              },
            ],
          })
          .on("lazyLoaded", function (event, slick, image, imageSource) {
            $(image).parents(".Img.observerSlick").addClass("loaded");
          });

        $(".relatedlinkList").on({
          init: function (event, slick) {
            document
              .querySelectorAll(
                ".relatedlinkArea .relatedlinkList .relatedlinkItem .item",
              )
              .forEach(function (item, index) {
                gsap.fromTo(
                  item,
                  {
                    x: -50,
                    opacity: 0,
                  },
                  {
                    x: 0,
                    opacity: 1,
                    duration: 1,
                    delay: index * 0.2,
                    ease: "power1.inOut",
                    scrollTrigger: {
                      trigger: ".relatedlinkArea",
                      start: "top 80%",
                    },
                    onComplete: function () {
                      // 動畫完成後，清除 GSAP 設定的 transform 與 opacity 等 inline 樣式
                      gsap.set(item, {
                        clearProps: "all",
                      });

                      item.style.transition = "all 0.5s ease-in-out";
                    },
                  },
                );
              });

            if (window.innerWidth < 321) {
              $(".relatedlinkList .slick-slide.slick-active")
                .eq(0)
                .addClass("after");
            } else if (window.innerWidth < 481) {
              $(".relatedlinkList .slick-slide.slick-active")
                .eq(1)
                .addClass("after");
            } else if (window.innerWidth < 640) {
              $(".relatedlinkList .slick-slide.slick-active")
                .eq(2)
                .addClass("after");
            } else if (window.innerWidth < 769) {
              $(".relatedlinkList .slick-slide.slick-active")
                .eq(3)
                .addClass("after");
            } else {
              $(".relatedlinkList .slick-slide.slick-active")
                .eq(4)
                .addClass("after");
            }
          },
          beforeChange: function (event, slick, currentSlide, nextSlide) {
            $(".relatedlinkList .slick-slide").removeClass("after");
          },

          afterChange: function (event, slick, currentSlide) {
            if (window.innerWidth < 321) {
              $(
                `.relatedlinkList .slick-slide[data-slick-index=${currentSlide}]`,
              ).addClass("after");
            } else if (window.innerWidth < 481) {
              $(
                `.relatedlinkList .slick-slide[data-slick-index=${currentSlide + 1}]`,
              ).addClass("after");
            } else if (window.innerWidth < 640) {
              $(
                `.relatedlinkList .slick-slide[data-slick-index=${currentSlide + 2}]`,
              ).addClass("after");
            } else if (window.innerWidth < 769) {
              $(
                `.relatedlinkList .slick-slide[data-slick-index=${currentSlide + 3}]`,
              ).addClass("after");
            } else {
              $(
                `.relatedlinkList .slick-slide[data-slick-index=${currentSlide + 4}]`,
              ).addClass("after");
            }
          },
        });

        $(".relatedlinkList")
          .slick({
            arrows: false,
            autoplaySpeed: 3000,
            cssEase: "ease-in-out",
            infinite: true,
            lazyLoad: "ondemand",
            speed: 600,
            slidesToShow: 5,
            slidesToScroll: 1,
            responsive: [
              {
                breakpoint: 769,
                settings: {
                  slidesToShow: 4,
                  dots: true,
                  dotsClass: "slick-dots center green",
                },
              },
              {
                breakpoint: 641,
                settings: {
                  slidesToShow: 3,
                  dots: true,
                  dotsClass: "slick-dots center green",
                },
              },
              {
                breakpoint: 481,
                settings: {
                  slidesToShow: 2,
                  dots: true,
                  dotsClass: "slick-dots center green",
                },
              },
              {
                breakpoint: 321,
                settings: {
                  slidesToShow: 1,
                  dots: true,
                  dotsClass: "slick-dots center green",
                },
              },
            ],
          })
          .on("lazyLoaded", function (event, slick, image, imageSource) {
            $(image).parents(".Img.observerSlick").addClass("loaded");
          });
        if ($(".ellipsis").length) {
          $(".ellipsis").dotdotdot({
            wrap: "letter",
            remove: [" ", ",", ";", ".", "!", "?"],
            watch: true,
          });
        }
      });
    </script>

    <script src="https://unpkg.com/scrollreveal"></script>

    <script nonce="<?= _CSP_NONCE_CODE ?>">
      $(function () {
        window.sr = ScrollReveal({
          mobile: true,
          scale: 1,
          duration: 1000,
          easing: "ease-in-out",
          viewFactor: window.innerWidth < 768 ? 0.2 : 0.4,
        });

        sr.reveal(".aboutArea .titleBox .title", {
          distance: "30px",
          origin: "left",
        });

        sr.reveal(".aboutArea .titleBox .subtitle", {
          distance: "30px",
          origin: "left",
        });

        sr.reveal(".aboutArea .titleBox .text", {
          distance: "30px",
          origin: "left",
        });

        sr.reveal(
          ".aboutArea .iconList .iconItem",
          {
            distance: "30px",
            origin: "left",
          },
          200,
        );

        sr.reveal(".projectArea .btnBox", {
          distance: "30px",
          origin: "top",
          delay: 300,
        });

        sr.reveal(".linkArea .btnBox", {
          distance: "30px",
          origin: "top",
        });
      });
    </script>

    <script nonce="<?= _CSP_NONCE_CODE ?>">
      document
        .querySelectorAll(".keyProductArea .keyProductItem")
        .forEach(function (item, index) {
          gsap.from(item.querySelector("img"), {
            scrollTrigger: {
              trigger: item,
              start: "top 90%",
            },
            scale: 1.15,
            duration: 6,

            ease: "power1.inOut",
          });
        });

      gsap.from(".linkArea .linkItem", {
        duration: 1,
        ease: "power1.inOut",
        opacity: 0,
        stagger: 0.2, // 每個元素間隔 0.2 秒開始動畫
        // 使用 function 根據索引返回不同的起始位置
        x: function (index) {
          return index % 2 === 0 ? -50 : 50; // 左邊或右邊
        },
        y: function (index) {
          return index < 2 ? -50 : 50; // 上面或下面
        },
        scrollTrigger: {
          trigger: ".linkArea",
          start: "top 90%",
        },
      });
    </script>
  </body>
</html>
